import{j as s}from"./index-BvoXJEUD.js";import{c as d}from"./useGetClassName-A214t1wA.js";import{u as C}from"./useGetClassName-CZySZImX.js";function f(g){var n,r;const{kcContext:p,i18n:j,doUseDefaultCss:m,Template:O,classes:h}=g,{getClassName:i}=C({doUseDefaultCss:m,classes:h}),{totp:t,mode:c,url:x,messagesPerField:a,stateChecker:u}=p,{msg:e,msgStr:v}=j,o={HmacSHA1:"SHA1",HmacSHA256:"SHA256",HmacSHA512:"SHA512"};return s.jsx(O,Object.assign({},{kcContext:p,i18n:j,doUseDefaultCss:m,classes:h},{active:"totp"},{children:s.jsxs(s.Fragment,{children:[s.jsxs("div",Object.assign({className:"row"},{children:[s.jsx("div",Object.assign({className:"col-md-10"},{children:s.jsx("h2",{children:e("authenticatorTitle")})})),t.otpCredentials.length===0&&s.jsxs("div",Object.assign({className:"subtitle col-md-2"},{children:[s.jsx("span",Object.assign({className:"required"},{children:"*"})),e("requiredFields")]}))]})),t.enabled&&s.jsxs("table",Object.assign({className:"table table-bordered table-striped"},{children:[s.jsx("thead",{children:t.otpCredentials.length>1?s.jsx("tr",{children:s.jsx("th",Object.assign({colSpan:4},{children:e("configureAuthenticators")}))}):s.jsx("tr",{children:s.jsx("th",Object.assign({colSpan:3},{children:e("configureAuthenticators")}))})}),s.jsx("tbody",{children:t.otpCredentials.map((l,b)=>s.jsxs("tr",{children:[s.jsx("td",Object.assign({className:"provider"},{children:e("mobile")})),t.otpCredentials.length>1&&s.jsx("td",Object.assign({className:"provider"},{children:l.id})),s.jsx("td",Object.assign({className:"provider"},{children:l.userLabel||""})),s.jsx("td",Object.assign({className:"action"},{children:s.jsxs("form",Object.assign({action:x.totpUrl,method:"post",className:"form-inline"},{children:[s.jsx("input",{type:"hidden",id:"stateChecker",name:"stateChecker",value:u}),s.jsx("input",{type:"hidden",id:"submitAction",name:"submitAction",value:"Delete"}),s.jsx("input",{type:"hidden",id:"credentialId",name:"credentialId",value:l.id}),s.jsx("button",Object.assign({id:`remove-mobile-${b}`,className:"btn btn-default"},{children:s.jsx("i",{className:"pficon pficon-delete"})}))]}))}))]},b))})]})),!t.enabled&&s.jsxs("div",{children:[s.jsx("hr",{}),s.jsxs("ol",Object.assign({id:"kc-totp-settings"},{children:[s.jsxs("li",{children:[s.jsx("p",{children:e("totpStep1")}),s.jsx("ul",Object.assign({id:"kc-totp-supported-apps"},{children:(n=t.supportedApplications)===null||n===void 0?void 0:n.map(l=>s.jsx("li",{children:e(l)},l))}))]}),c&&c=="manual"?s.jsxs(s.Fragment,{children:[s.jsxs("li",{children:[s.jsx("p",{children:e("totpManualStep2")}),s.jsx("p",{children:s.jsx("span",Object.assign({id:"kc-totp-secret-key"},{children:t.totpSecretEncoded}))}),s.jsx("p",{children:s.jsx("a",Object.assign({href:t.qrUrl,id:"mode-barcode"},{children:e("totpScanBarcode")}))})]}),s.jsxs("li",{children:[s.jsx("p",{children:e("totpManualStep3")}),s.jsxs("ul",{children:[s.jsxs("li",Object.assign({id:"kc-totp-type"},{children:[e("totpType"),": ",e(`totp.${t.policy.type}`)]})),s.jsxs("li",Object.assign({id:"kc-totp-algorithm"},{children:[e("totpAlgorithm"),": ",(r=o==null?void 0:o[t.policy.algorithm])!==null&&r!==void 0?r:t.policy.algorithm]})),s.jsxs("li",Object.assign({id:"kc-totp-digits"},{children:[e("totpDigits"),": ",t.policy.digits]})),t.policy.type==="totp"?s.jsxs("li",Object.assign({id:"kc-totp-period"},{children:[e("totpInterval"),": ",t.policy.period]})):s.jsxs("li",Object.assign({id:"kc-totp-counter"},{children:[e("totpCounter"),": ",t.policy.initialCounter]}))]})]})]}):s.jsxs("li",{children:[s.jsx("p",{children:e("totpStep2")}),s.jsx("p",{children:s.jsx("img",{id:"kc-totp-secret-qr-code",src:`data:image/png;base64, ${t.totpSecretQrCode}`,alt:"Figure: Barcode"})}),s.jsx("p",{children:s.jsx("a",Object.assign({href:t.manualUrl,id:"mode-manual"},{children:e("totpUnableToScan")}))})]}),s.jsxs("li",{children:[s.jsx("p",{children:e("totpStep3")}),s.jsx("p",{children:e("totpStep3DeviceName")})]})]})),s.jsx("hr",{}),s.jsxs("form",Object.assign({action:x.totpUrl,className:i("kcFormClass"),id:"kc-totp-settings-form",method:"post"},{children:[s.jsx("input",{type:"hidden",id:"stateChecker",name:"stateChecker",value:u}),s.jsxs("div",Object.assign({className:i("kcFormGroupClass")},{children:[s.jsxs("div",Object.assign({className:"col-sm-2 col-md-2"},{children:[s.jsx("label",Object.assign({htmlFor:"totp",className:"control-label"},{children:e("authenticatorCode")})),s.jsx("span",Object.assign({className:"required"},{children:"*"}))]})),s.jsxs("div",Object.assign({className:"col-sm-10 col-md-10"},{children:[s.jsx("input",{type:"text",id:"totp",name:"totp",autoComplete:"off",className:i("kcInputClass"),"aria-invalid":a.existsError("totp")}),a.existsError("totp")&&s.jsx("span",Object.assign({id:"input-error-otp-code",className:i("kcInputErrorMessageClass"),"aria-live":"polite"},{children:a.get("totp")}))]})),s.jsx("input",{type:"hidden",id:"totpSecret",name:"totpSecret",value:t.totpSecret}),c&&s.jsx("input",{type:"hidden",id:"mode",value:c})]})),s.jsxs("div",Object.assign({className:i("kcFormGroupClass")},{children:[s.jsxs("div",Object.assign({className:"col-sm-2 col-md-2"},{children:[s.jsx("label",Object.assign({htmlFor:"userLabel",className:i("kcLabelClass")},{children:e("totpDeviceName")})),t.otpCredentials.length>=1&&s.jsx("span",Object.assign({className:"required"},{children:"*"}))]})),s.jsxs("div",Object.assign({className:"col-sm-10 col-md-10"},{children:[s.jsx("input",{type:"text",id:"userLabel",name:"userLabel",autoComplete:"off",className:i("kcInputClass"),"aria-invalid":a.existsError("userLabel")}),a.existsError("userLabel")&&s.jsx("span",Object.assign({id:"input-error-otp-label",className:i("kcInputErrorMessageClass"),"aria-live":"polite"},{children:a.get("userLabel")}))]}))]})),s.jsx("div",Object.assign({id:"kc-form-buttons",className:d(i("kcFormGroupClass"),"text-right")},{children:s.jsxs("div",Object.assign({className:i("kcInputWrapperClass")},{children:[s.jsx("input",{type:"submit",className:d(i("kcButtonClass"),i("kcButtonPrimaryClass"),i("kcButtonLargeClass")),id:"saveTOTPBtn",value:v("doSave")}),s.jsx("button",Object.assign({type:"submit",className:d(i("kcButtonClass"),i("kcButtonDefaultClass"),i("kcButtonLargeClass"),i("kcButtonLargeClass")),id:"cancelTOTPBtn",name:"submitAction",value:"Cancel"},{children:e("doCancel")}))]}))}))]}))]})]})}))}export{f as default};
