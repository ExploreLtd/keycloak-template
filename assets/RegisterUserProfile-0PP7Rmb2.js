import{r as t,j as e}from"./index-DGZejY09.js";import{c as B}from"./useGetClassName-jxT2X9z4.js";import{u as I}from"./useFormValidation-BfXknbfB.js";import{u as E}from"./useGetClassName-DGPBJ0u3.js";function V(v){const{kcContext:c,onIsFormSubmittableValueChange:m,i18n:d,getClassName:r,BeforeField:u,AfterField:a}=v,{advancedMsg:i,msg:C}=d,{formValidationState:{fieldStateByAttributeName:p,isFormSubmittable:x},formValidationDispatch:l,attributesWithPassword:k}=I({kcContext:c,i18n:d}),N=t.useMemo(()=>{if(typeof window>"u")return{};const s=new URLSearchParams(window.location.search);return{email:s.get("loginHint")??s.get("login_hint")??void 0,firstName:s.get("firstName")??void 0,lastName:s.get("lastName")??void 0,username:s.get("username")??void 0}},[]),f=t.useRef(!1);t.useEffect(()=>{f.current||(f.current=!0,Object.entries(N).forEach(([s,j])=>{if(j&&p[s]){const o=p[s].value;(!o||o==="")&&l({action:"update value",name:s,newValue:j})}}))},[]),t.useEffect(()=>{m(x)},[x]);let F="";return e.jsx(e.Fragment,{children:k.map((s,j)=>{const{group:o="",groupDisplayHeader:S="",groupDisplayDescription:y=""}=s,{value:w,displayableErrors:h}=p[s.name],b=B(r("kcFormGroupClass"),h.length!==0&&r("kcFormGroupErrorClass"));return e.jsxs(t.Fragment,{children:[o!==F&&(F=o)!==""&&e.jsxs("div",{className:b,children:[e.jsx("div",{className:r("kcContentWrapperClass"),children:e.jsx("label",{id:`header-${o}`,className:r("kcFormGroupHeader"),children:i(S)||F})}),y!==""&&e.jsx("div",{className:r("kcLabelWrapperClass"),children:e.jsx("label",{id:`description-${o}`,className:r("kcLabelClass"),children:i(y)})})]}),u&&e.jsx(u,{attribute:s}),e.jsxs("div",{className:b,children:[e.jsxs("div",{className:r("kcLabelWrapperClass"),children:[e.jsx("label",{htmlFor:s.name,className:r("kcLabelClass"),children:i(s.displayName??"")}),s.required&&e.jsx(e.Fragment,{children:"*"})]}),e.jsxs("div",{className:r("kcInputWrapperClass"),children:[(()=>{const{options:g}=s.validators;return g!==void 0?e.jsx("select",{id:s.name,name:s.name,onChange:n=>l({action:"update value",name:s.name,newValue:n.target.value}),onBlur:()=>l({action:"focus lost",name:s.name}),value:w,children:e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"",selected:!0,disabled:!0,hidden:!0,children:C("selectAnOption")}),g.options.map(n=>e.jsx("option",{value:n,children:n},n))]})}):e.jsx("input",{type:(()=>{switch(s.name){case"password-confirm":case"password":return"password";default:return"text"}})(),id:s.name,name:s.name,value:w,onChange:n=>l({action:"update value",name:s.name,newValue:n.target.value}),onBlur:()=>l({action:"focus lost",name:s.name}),className:r("kcInputClass"),"aria-invalid":h.length!==0,disabled:s.readOnly,autoComplete:s.autocomplete})})(),h.length!==0&&(()=>{const g=`input-error-${s.name}`;return e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`#${g} > span: { display: block; }`}),e.jsx("span",{id:g,className:r("kcInputErrorMessageClass"),style:{position:h.length===1?"absolute":void 0},"aria-live":"polite",children:h.map(({errorMessage:n})=>n)})]})})()]})]}),a&&e.jsx(a,{attribute:s})]},j)})})}function W(v){const{kcContext:c,i18n:m,doUseDefaultCss:d,Template:r,classes:u}=v,{getClassName:a}=E({doUseDefaultCss:d,classes:u}),{url:i,messagesPerField:C,recaptchaRequired:p,recaptchaSiteKey:x}=c,{msg:l,msgStr:k}=m,[N,f]=t.useState(!1);return e.jsx(r,{kcContext:c,i18n:m,doUseDefaultCss:d,classes:u,displayMessage:C.exists("global"),displayRequiredFields:!0,headerNode:l("registerTitle"),children:e.jsxs("form",{id:"kc-register-form",className:a("kcFormClass"),action:i.registrationAction,method:"post",children:[e.jsx(V,{kcContext:c,onIsFormSubmittableValueChange:f,i18n:m,getClassName:a}),p&&e.jsx("div",{className:"form-group",children:e.jsx("div",{className:a("kcInputWrapperClass"),children:e.jsx("div",{className:"g-recaptcha","data-size":"compact","data-sitekey":x})})}),e.jsxs("div",{className:a("kcFormGroupClass"),style:{marginBottom:30},children:[e.jsx("div",{id:"kc-form-options",className:a("kcFormOptionsClass"),children:e.jsx("div",{className:a("kcFormOptionsWrapperClass"),children:e.jsx("span",{children:e.jsx("a",{href:i.loginUrl,children:l("backToLogin")})})})}),e.jsx("div",{id:"kc-form-buttons",className:a("kcFormButtonsClass"),children:e.jsx("input",{className:B(a("kcButtonClass"),a("kcButtonPrimaryClass"),a("kcButtonBlockClass"),a("kcButtonLargeClass")),type:"submit",value:k("doRegister"),disabled:!N})})]})]})})}export{W as default};
